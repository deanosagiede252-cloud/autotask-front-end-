import dotenv from 'dotenv'; import User from '../models/User.js'; import bcrypt from 'bcrypt'; import mongoose from 'mongoose'; dotenv.config(); export async function ensureFounderExists(){ const email = process.env.FOUNDER_EMAIL; const pass = process.env.FOUNDER_PASSWORD; if(!email || !pass) return; try{ if(mongoose.connection.readyState !== 1) await mongoose.connect(process.env.MONGO_URI); const existing = await User.findOne({ email }); if(existing) return; const hash = await bcrypt.hash(pass, parseInt(process.env.BCRYPT_SALT_ROUNDS||12,10)); const u = new User({ email, passwordHash: hash, name:'Founder', role:'founder' }); await u.save(); console.log('Founder created'); }catch(e){ console.warn('Founder ensure failed', e.message); } }